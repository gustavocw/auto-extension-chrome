const p=(a,s={})=>{var e,t,l,n;if(!a)return Promise.resolve(!1);const i={...{behavior:"smooth",block:"center",delay:800},...s},c=((t=(e=a.getAttribute("style"))==null?void 0:e.match(/background-color:[^;]+/))==null?void 0:t[0])||"",o=((n=(l=a.getAttribute("style"))==null?void 0:l.match(/transition:[^;]+/))==null?void 0:n[0])||"";return a.setAttribute("style",`${a.getAttribute("style")||""}; transition: background-color 0.5s ease; background-color: rgba(255, 243, 224, 0.8);`),a.scrollIntoView({behavior:i.behavior,block:i.block}),new Promise(u=>{setTimeout(()=>{setTimeout(()=>{let d=a.getAttribute("style")||"";d=d.replace(/background-color:[^;]+;?/,c?c+";":"").replace(/transition:[^;]+;?/,o?o+";":""),a.setAttribute("style",d.trim())},500),u(!0)},i.delay)})},q=`
Você é um assistente especializado em criar propostas para freelancers no Workana.
Analise a descrição do projeto abaixo e crie uma proposta profissional.

DESCRIÇÃO DO PROJETO:
###
{description}
###

INFORMAÇÕES SOBRE O FREELANCER:
###
{aboutYou}
###

METODOLOGIA DE MARKETING PREFERIDA:
###
{marketingMethodology}
###

O freelancer cobra R$ {hourlyRate} por hora.

PERGUNTAS ESPECÍFICAS DO PROJETO:
1. Informe sua disponibilidade para começar
2. Defina de quais informações você precisa para começar
3. Explique porque você é o candidato ideal

ATENÇÃO: REGRAS IMPORTANTES QUE VOCÊ DEVE SEGUIR:
1. NUNCA mencione valores monetários, preços, taxas ou comissões na descrição ou respostas.
2. NUNCA inclua seu contato pessoal como e-mail, telefone, WhatsApp ou links para redes sociais.
3. NUNCA mencione plataformas externas que possam ser usadas para comunicação fora do Workana.
4. Mantenha a proposta profissional, clara e objetiva.
5. Use primeira pessoa do singular (eu).
6. Incorpore naturalmente as informações sobre o freelancer e sua metodologia de marketing na proposta.
7. Adapte a proposta de acordo com o tipo de projeto, demonstrando compreensão das necessidades do cliente.
8. Responda especificamente à pergunta "Explique porque você é o candidato ideal" com detalhes convincentes.
9. Em ser o candidato ideal pode dizer sobre o projeto Credliber, app de venda de FGTS com mais de 20k de downloads e mis de 15 milhões de reais movimentdos.

Se houver perguntas específicas na descrição do projeto após a seção "PERGUNTAS QUE PRECISAM SER RESPONDIDAS:", 
forneça respostas detalhadas e personalizadas para cada uma delas, baseando-se no contexto do projeto.

Sua resposta deve seguir estritamente este formato JSON:
{
  "description": "Uma proposta profissional e personalizada baseada na descrição do projeto. Deve ser detalhada, demonstrar compreensão do projeto e destacar as habilidades relevantes. Entre 150-300 palavras. NUNCA mencione valores monetários ou formas de contato externas.",
  "deliveryTime": "Prazo de entrega sugerido (ex: '7 dias', '2 semanas', etc.)",
  "suggestedHours": número inteiro representando quantas horas você estima para concluir este projeto,
  "answersToQuestions": "Uma resposta convincente específica para a pergunta 'Explique porque você é o candidato ideal', destacando experiência, habilidades relevantes para este projeto e diferenciais competitivos."
}
`,_="https://api.openai.com/v1/chat/completions",f={start:"Estou analisando o projeto e gerando sua proposta...",analyzing:"Analisando descrição do projeto...",generating:"Gerando proposta personalizada...",finalizing:"Finalizando sua proposta...",error:"Erro ao gerar proposta. Tentando novamente...",complete:"Proposta gerada com sucesso!"},g={description:"Olá, analisei seu projeto e tenho interesse em colaborar. Tenho experiência com projetos similares e posso entregar resultados de qualidade dentro do prazo estipulado.",deliveryTime:"7 dias",suggestedHours:150,answersToQuestions:"Sou o candidato ideal para este projeto porque possuo extensa experiência com projetos similares, domino as tecnologias necessárias e tenho um histórico comprovado de entregas pontuais e de alta qualidade. Meu diferencial é combinar habilidades técnicas com uma visão estratégica, sempre focado em entregar resultados que superem as expectativas do cliente.",availabilityAnswer:"Posso começar imediatamente após a aprovação da proposta.",dataNeededAnswer:"Precisarei de acesso aos requisitos detalhados do projeto, exemplos ou referências, e um contato para esclarecimento de dúvidas durante o desenvolvimento."},m={descriptionInput:"#BidContent",deliveryTimeInput:"#BidDeliveryTime",hoursInput:"#Hours",submitButton:'input[type="submit"].btn-primary',defaultQuestions:'input[id^="defaultProjectQuestionsAnswers-question-"]',customQuestions:'input[id^="customProjectQuestionsAnswers-question-"]',skillsList:".multi-select-results-item",skillsDropdown:"input.multi-select-search-field",portfolioButtons:"label#selectPortfolio"};function x(a=f.start){P();const s=document.createElement("div");s.id="gpt-loading-indicator",s.style.cssText=`
    position: fixed;
    top: 20px;
    right: 20px;
    background: linear-gradient(to right, #9333ea, #6366f1);
    color: white;
    padding: 15px 20px;
    border-radius: 8px;
    font-family: sans-serif;
    font-size: 14px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    z-index: 10000;
    display: flex;
    align-items: center;
    min-width: 250px;
  `;const r=document.createElement("span");return r.textContent=a,s.appendChild(r),document.body.appendChild(s),s}function h(a){const s=document.getElementById("gpt-loading-indicator");if(s){const r=s.querySelector("span");r&&(r.textContent=a)}else x(a)}function P(){const a=document.getElementById("gpt-loading-indicator");a&&a.remove()}async function y(a){var o,e,t;const{description:s,hourlyRate:r="100",maxTokens:i=1200,temperature:c=.7}=a;x();try{h(f.analyzing);const l="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",n=localStorage.getItem("workana_about_you")||"",u=localStorage.getItem("workana_marketing_methodology")||"",d=q.replace("{description}",s).replace("{hourlyRate}",r).replace("{aboutYou}",n||"Informações não fornecidas").replace("{marketingMethodology}",u||"Metodologia não fornecida");h(f.generating);const b=await fetch(_,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify({model:"gpt-3.5-turbo",messages:[{role:"user",content:d}],max_tokens:i,temperature:c,n:1})});if(!b.ok){const w=await b.json();throw new Error(`Erro na API do OpenAI: ${((o=w.error)==null?void 0:o.message)||b.statusText}`)}h(f.finalizing);const T=(t=(e=(await b.json()).choices[0])==null?void 0:e.message)==null?void 0:t.content;if(!T)throw new Error("Resposta vazia da API do OpenAI");try{const w=JSON.parse(T);return w.suggestedHours=150,h(f.complete),setTimeout(()=>{P()},1500),w}catch{throw new Error("Formato inválido na resposta da API")}}catch{return h(f.error),setTimeout(()=>{P()},3e3),{description:g.description,deliveryTime:g.deliveryTime,suggestedHours:150,answersToQuestions:g.answersToQuestions}}}async function D(a){const s=document.getElementById(m.descriptionInput.replace("#","")),r=document.getElementById(m.deliveryTimeInput.replace("#","")),i=document.getElementById(m.hoursInput.replace("#",""));if(!s||!r||!i)return;try{let o;if(a)o=a;else{const e=localStorage.getItem("workana_project_description");if(!e)throw new Error("Descrição do projeto não disponível");const t=localStorage.getItem("workana_hourly_rate")||"50";o=await y({description:e,hourlyRate:t})}o.suggestedHours=150,await p(s),s.focus(),s.value=o.description,s.dispatchEvent(new Event("input",{bubbles:!0})),await new Promise(e=>setTimeout(e,500)),await p(r),r.focus(),r.value="A ser definido em reunião",r.dispatchEvent(new Event("input",{bubbles:!0})),await new Promise(e=>setTimeout(e,500)),await p(i),i.focus(),i.value=o.suggestedHours.toString(),i.dispatchEvent(new Event("input",{bubbles:!0})),await k(),localStorage.setItem("workana_gpt_answers",o.answersToQuestions)}catch{await p(s),s.focus(),s.value=g.description,s.dispatchEvent(new Event("input",{bubbles:!0})),await new Promise(e=>setTimeout(e,500)),await p(r),r.focus(),r.value="A ser definido em reunião",r.dispatchEvent(new Event("input",{bubbles:!0})),await new Promise(e=>setTimeout(e,500)),await p(i),i.focus(),i.value="150",i.dispatchEvent(new Event("input",{bubbles:!0})),await k()}const c=document.querySelector(m.submitButton);c&&(await p(c),c.style.transition="box-shadow 0.5s ease, transform 0.3s ease",c.style.boxShadow="0 0 12px 4px #4CAF50",c.style.transform="scale(1.05)")}async function k(){const a={availability_to_start:"availabilityAnswer",data_needed_to_start:"dataNeededAnswer",chosen_one_reason:"answersToQuestions"},s=document.querySelectorAll('input[id^="defaultProjectQuestionsAnswers-question-"]'),r=document.querySelectorAll('input[id^="customProjectQuestionsAnswers-question-"]');if(s.length===0&&r.length===0)return;const i=[];if(s.forEach(c=>{var u;const o=c.id,e=o.match(/defaultProjectQuestionsAnswers-question-(.+)/);if(!e)return;const t=e[1],l=document.querySelector(`label[for="${o}"]`),n=((u=l==null?void 0:l.textContent)==null?void 0:u.trim())||"";i.push({id:t,fieldId:o,question:n,answer:""})}),r.forEach(c=>{var u;const o=c.id,e=o.match(/customProjectQuestionsAnswers-question-(.+)/);if(!e)return;const t=e[1],l=document.querySelector(`label[for="${o}"]`),n=((u=l==null?void 0:l.textContent)==null?void 0:u.trim())||"";i.push({id:t,fieldId:o,question:n,answer:""})}),i.length!==0)for(const c of i){let o="";a[c.id]?o=g[a[c.id]]:o=g.answersToQuestions;const e=document.getElementById(c.fieldId);e&&(await p(e),e.focus(),e.value=o,e.dispatchEvent(new Event("input",{bubbles:!0})),await new Promise(t=>setTimeout(t,300)))}}async function I(a){async function s(){if(a)return a;const c=localStorage.getItem("workana_project_description");if(!c)return console.error("Descrição do projeto não encontrada no localStorage."),null;const o=localStorage.getItem("workana_hourly_rate")||"50";try{return await y({description:c,hourlyRate:o})}catch(e){return console.error("Erro ao gerar proposta com GPT:",e),null}}const r=document.getElementById("Hours");if(!r){console.error("Campo de horas não encontrado.");return}const i=await s();if(!i){console.error("Falha ao obter resposta do GPT, não é possível prosseguir.");return}await p(r),r.focus(),r.value=i.suggestedHours.toString(),r.dispatchEvent(new Event("input",{bubbles:!0})),D(i)}async function E(){function a(){return window.location.href.includes("workana.com/job/")}function s(){var e;const o=document.querySelector("div.expander.js-expander-passed");return((e=o==null?void 0:o.textContent)==null?void 0:e.trim())||null}function r(o){try{localStorage.setItem("workana_project_description",o)}catch{}}function i(o){o.style.transition="box-shadow 0.3s, transform 0.3s",o.style.boxShadow="0 0 10px 2px #4CAF50",o.style.transform="scale(1.05)",setTimeout(()=>{o.style.boxShadow="",o.style.transform=""},600)}function c(){const o=document.getElementById("bid_button");o&&(i(o),setTimeout(()=>{o.click()},800))}if(a()){const o=s();o&&r(o),setTimeout(()=>{c()},Math.floor(1e3+Math.random()*500))}}async function v(a){async function s(){if(a)return a;const o=localStorage.getItem("workana_project_description");if(!o)return console.error("Descrição do projeto não encontrada no localStorage."),null;const e=localStorage.getItem("workana_hourly_rate")||"50";try{return await y({description:o,hourlyRate:e})}catch(t){return console.error("Erro ao gerar proposta com GPT:",t),null}}async function r(o){await p(o),o.click()}async function i(o){const e=document.querySelectorAll(m.portfolioButtons);if(e.length===0){console.log("Nenhum projeto de portfólio encontrado. Avançando para o próximo passo..."),window.location.href.includes("workana.com/messages/bid/")?I(o):(console.log("Não está na página de projeto específico, apenas scanProject será executado"),E());return}const t=Math.min(3,e.length);for(let n=0;n<t;n++){const u=e[n];await r(u),await new Promise(d=>setTimeout(d,500))}window.location.href.includes("workana.com/messages/bid/")?I(o):(console.log("Não está na página de projeto específico, apenas scanProject será executado"),E())}const c=await s();if(!c){console.error("Falha ao obter resposta do GPT, não é possível prosseguir.");return}await i(c)}async function A(a=5e3){return new Promise(s=>{let i=0;const c=()=>{document.querySelectorAll(m.skillsList).length>0?s(!0):i>=a?s(!1):(i+=100,setTimeout(c,100))};c()})}async function S(a){async function s(){if(a)return a;const e=localStorage.getItem("workana_project_description");if(!e)return console.error("Descrição do projeto não encontrada no localStorage."),null;const t=localStorage.getItem("workana_hourly_rate")||"50";try{return await y({description:e,hourlyRate:t})}catch(l){return console.error("Erro ao gerar proposta com GPT:",l),null}}async function r(e){await p(e),e.click()}async function i(){const e=[m.skillsDropdown,".multi-select-search-field",".multi-select-container input",".multi-select-placeholder",".skills-container .multi-select",'input[placeholder*="habilidade"]',".skills-selection-wrapper input"];let t=null;for(const l of e){const n=document.querySelector(l);if(n){t=n,console.log(`Campo de habilidades encontrado com seletor: ${l}`);break}}if(!t){const l=document.querySelectorAll('div[class*="skill" i]');if(l.length>0){console.log("Container de habilidades encontrado por classe parcial");for(const n of l){const u=n.querySelector("input")||n.querySelector(".multi-select");if(u){t=u;break}}}}if(!t)return console.error("Nenhum campo de seleção de habilidades encontrado após múltiplas tentativas."),!1;await p(t);try{if(t.focus(),await new Promise(n=>setTimeout(n,300)),t.click(),await new Promise(n=>setTimeout(n,500)),t instanceof HTMLInputElement&&(t.value=" ",t.dispatchEvent(new Event("input",{bubbles:!0})),await new Promise(n=>setTimeout(n,300)),t.value="",t.dispatchEvent(new Event("input",{bubbles:!0}))),t.click(),!await A(2e3)){const n=t.parentElement;n&&(await p(n),n.click(),await new Promise(u=>setTimeout(u,500)))}return!0}catch(l){return console.error("Erro ao interagir com campo de habilidades:",l),!1}}async function c(e){const t=document.querySelectorAll(m.skillsList);if(t.length===0){console.log("Nenhuma habilidade disponível para seleção. Avançando para o próximo passo..."),v(e);return}const l=Math.min(5,t.length);for(let n=0;n<l;n++){const u=t[n];await r(u),await new Promise(d=>setTimeout(d,500))}console.log("Habilidades selecionadas."),v(e)}async function o(){const e=await s();if(!e){console.error("Falha ao obter resposta do GPT, não é possível prosseguir.");return}await i()?await A()?await c(e):(console.log("Lista de habilidades não apareceu. Avançando para o próximo passo..."),v(e)):(console.log("Não foi possível abrir o dropdown de habilidades. Avançando para o próximo passo..."),v(e))}o()}async function R(a,s=5e3){return new Promise(r=>{let c=0;const o=()=>{document.querySelector(a)?r(!0):c>=s?r(!1):(c+=100,setTimeout(o,100))};o()})}async function C(){let a=null;function s(){const e=[];return document.querySelectorAll(m.defaultQuestions).forEach(n=>{var d;const u=(d=n.closest(".form-group"))==null?void 0:d.querySelector("label");u&&u.textContent&&e.push({id:n.id,question:u.textContent.trim(),element:n})}),document.querySelectorAll(m.customQuestions).forEach(n=>{var d;const u=(d=n.closest(".form-group"))==null?void 0:d.querySelector("label");u&&u.textContent&&e.push({id:n.id,question:u.textContent.trim(),element:n})}),e}async function r(e){const t=localStorage.getItem("workana_project_description");if(!t)return console.error("Descrição do projeto não encontrada no localStorage."),null;const l=localStorage.getItem("workana_hourly_rate")||"50",n=e.map(d=>`- ${d.question}`).join(`
`),u=`${t}

PERGUNTAS QUE PRECISAM SER RESPONDIDAS:
${n}`;try{return await y({description:u,hourlyRate:l})}catch(d){return console.error("Erro ao gerar proposta com GPT:",d),null}}async function i(e,t){await p(e),e.value=t,e.dispatchEvent(new Event("input",{bubbles:!0}))}async function c(e,t){const l=new Set;for(const n of e){let u=t.answersToQuestions;l.has(u)&&(u=`${u} Além disso, minha experiência com o projeto Credliber, um app de venda de FGTS com mais de 20k de downloads e mais de 15 milhões de reais movimentados, me torna ainda mais qualificado.`),l.add(u),await i(n.element,u),await new Promise(d=>setTimeout(d,300))}}async function o(){if(!await R(`${m.defaultQuestions}, ${m.customQuestions}`)){console.log("Inputs de perguntas não carregaram. Avançando para o próximo passo..."),await S(a);return}const t=s();if(t.length===0){console.log("Nenhuma pergunta encontrada. Avançando para o próximo passo..."),await S(a);return}if(a=await r(t),!a){console.error("Falha ao obter resposta do GPT, não é possível prosseguir.");return}localStorage.setItem("workana_gpt_answers",a.answersToQuestions),await c(t,a),await S(a)}o()}async function j(){const a=window.location.href;a.includes("workana.com/job/")?(console.log("Página de projeto detectada."),await E()):a.includes("workana.com/messages/bid/")?(console.log("Página de envio de proposta detectada."),await C()):(console.log("Não está na página de projeto nem na página de proposta. Executando apenas scanProject."),await E())}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",j):j();
